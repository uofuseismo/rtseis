# Installation Instructions

Below are instructions for building RTSeis from source on Linux.

## Dependencies

Prior to building RTSeis the following dependencies must be cleared:

   1. A C11 or higher C compiler.
   2. A C++17 or higher C++ compiler.
   3. [CMake](https://cmake.org/) V3.2 or higher.
   4. [Intel's Performance Primitives](https://software.intel.com/en-us/intel-ipp) performs most of the heavy lifting.
   5. [Intel's MKL](https://software.intel.com/en-us/mkl) backfills some of the matrix algebra and any massive correlations.
   6. [GoogleTest](https://github.com/google/googletest) for regression testing.

Future dependency: 

   1. [SpdLog](https://github.com/gabime/spdlog) for logging.  This should be better in a production system.

In addition, if the Python bindings are sought

   1. Python3 with NumPy and SciPy.
   2. [pybind11](https://pybind11.readthedocs.io/en/stable/) will generate Python bindings that call the RTSeis C++ library.

If the API documentation is to be generated you will additionally require

   1. [Doxygen](http://www.doxygen.nl/)

## Getting the software

In the directory of your choice enter

    git clone https://github.com/uofuseismo/rtseis.git

This will create an rtseis directory.

## Configuring

After descending into rtseis you will have to configure CMake.  I prefer to do this with scripts.  For example, you can make a config.sh

    #!/bin/sh
    # Set the compilers
    export CXX=/usr/bin/clang++-6.0
    # Set the libraries
    export IPP_DIR=/opt/intel/ipp
    export IPP_LIB_ROOT=${IPP_DIR}/lib/intel64
    export MKL_DIR=/opt/intel/mkl
    export MKL_LIB_ROOT=${MKL_DIR}/lib/intel64
    export GTEST_ROOT=/local
    # Only matters if you intend to use Python 
    export pybind11_INCLUDE_DIR=/usr/local/include/pybind11
    # Set the working directory
    export BUILD_DIR=clang_build 
    # Clobber the existing directory for a fresh build
    if [ -d ${BUILD_DIR} ]; then
       rm -r {BUILD_DIR}
    fi
    mkdir ${BUILD_DIR}
    # Descend into build directory 
    cd ${BUILD_DIR}
    # Configure a build release - to disable Python wrapping remove -DRTSEIS_WRAP_PYTHON
    cmake ../ \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_CXX_COMPILER=${CXX} \
    -DCMAKE_CXX_FLAGS="-Wall" \
    -DRTSEIS_WRAP_PYTHON=ON \
    -Dpybind11_INCLUDE_DIR="/usr/local/include/pybind11"

## Building

Now that the Makefiles have been generated, you can build the software can be built by typing

    make

in the command line.  For a parallel build, with say 4, processes, you could alternatively do

    make -j 4

## Testing

Following a successful compilation the software should be tested by typing

    make test

or 

    ctest

in the command line.

## Installing

make install isn't implemented yet in the cmake

## Generating the Doxygen

The API documentation can be generated by typing

    doxygen Doxyfile

in the root source directory.

